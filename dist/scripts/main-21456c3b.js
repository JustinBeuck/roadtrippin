"use strict";var app=angular.module("roadtrippin",["ngRoute"]);app.config(["$routeProvider",function(e){e.when("/AddVehicle",{templateUrl:"templates/carControllerView.html",controller:"carController"}).when("/AddAddress",{templateUrl:"templates/addressView.html",controller:"carController"}).when("/",{templateUrl:"templates/homeView.html",controller:"mainController"}).otherwise({redirectTo:"/"})}]),app.controller("mainController",["$scope","$location","$http",function(e,t){e.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],e.nextView=function(){console.log("works??"),t.path("/AddVehicle")},e.nextView2=function(){console.log("still works??"),t.path("/AddAddress")}}]),function(){var e=function(e,t,n,o){e.selectedtrimId="",t.get("https://api.edmunds.com/api/vehicle/v2/makes?fmt=json&api_key=7fr982626at7633r7qgcwu87").then(function(t){e.makes=t.data.makes},function(t){e.error1=JSON.stringify(t)}),e.getmodels=function(n){var o=parseInt(n),i=_.find(e.makes,function(e){return e.id===o});t.get("https://api.edmunds.com/api/vehicle/v2/"+i.name+"/models?fmt=json&api_key=7fr982626at7633r7qgcwu87").then(function(t){e.models=t.data.models},function(t){e.error2=JSON.stringify(t)})},e.getyears=function(t){var n=_.find(e.models,function(e){return e.id===t});e.years=n.years},e.getTrims=function(t){console.log("finding yearIdStr",t),makeYearId=parseInt(t);var n=_.find(e.years,function(e){return e.id===makeYearId});e.styles=n.styles},e.getFuelCapacity=function(){t.get("https://api.edmunds.com/api/vehicle/v2/styles/"+e.selectedtrimId.id+"/equipment?availability=standard&equipmentType=OTHER&name=SPECIFICATIONS&fmt=json&api_key=7fr982626at7633r7qgcwu87").then(function(t){console.log(t),e.milesPerGallon=_.find(t.data.equipment[0].attributes,function(e){return"Epa Combined Mpg"==e.name}),console.log(e.milesPerGallon.value),e.fuelCapacity=_.find(t.data.equipment[0].attributes,function(e){return"Fuel Capacity"==e.name}),console.log(e.fuelCapacity.value),e.milesToEmptyTank=Math.round(e.milesPerGallon.value*e.fuelCapacity.value),console.log(e.milesToEmptyTank),o.milesToEmptyTank=e.milesToEmptyTank,e.grabMiles(e.milesToEmptyTank),setTimeout(function(){$(".dial").knob({readOnly:!0,width:"100",fgColor:"#c0392b",skin:"tron",thickness:".5",displayPrevious:!0}),$(".dial2").knob({readOnly:!0,width:"100",fgColor:"#3498db",skin:"tron",thickness:".5",displayPrevious:!0}),$(".dial3").knob({readOnly:!0,width:"100",fgColor:"#16a085",skin:"tron",thickness:".5",displayPrevious:!0})},1)},function(t){e.error2=JSON.stringify(t)})},e.nextView2=function(){n.path("/AddAddress")}};app.controller("carController",["$scope","$http","$location","$rootScope",e])}(),app.controller("tripController",["$scope","$http",function(e,t){e.grabMiles=function(t){e.milesToEmpty=t},e.updateMilesPerMarker=function(t){e.milesPerMarker=t,e.gasLocation()},e.gasLocation=function(){e.num=Math.floor(e.milesToEmpty/e.milesPerMarker)},e.gasStations=function(n,o){t.get("http://api.mygasfeed.com/stations/radius/"+o+"/"+n+"/30/reg/price/8fkb7t88tk.json?").then(function(t){for(var n=0;10>n;n++)console.log(t.data.stations[n]),e.$broadcast("add-gas-station",{lat:t.data.stations[n].lat,lng:t.data.stations[n].lng,name:t.data.stations[n].station,address:t.data.stations[n].address,city:t.data.stations[n].city,state:t.data.stations[n].region,zip:t.data.stations[n].zip,reg:t.data.stations[n].reg_price})})}}]),app.directive("map",function(){var e,t,n,o,i=new google.maps.DirectionsRenderer,a=new google.maps.DirectionsService,r=new google.maps.Geocoder;return n={restrict:"EAC",transclude:!0,scope:{destination:"@",markerContent:"@",zoom:"=",type:"@",directions:"@"},replace:!0,template:'<form novalidate name="mapContainer" class="mapContainer panel"><div class="directions" ng-show="directions || directions==undefined"><label>Origin:</label><br /><input type="text" ng-model="origin" name="origin"  required><small class="error" id="wrongAddress">Error: \n <span>Sorry this is not a valid address.</span></small><br /><label>Destination:</label><br /><input ng-model="endPoint" type="text" name="Destination" required><br /><br /></div><div id="theMap"></div><br /><button class="getDirections" ng-click="getDirections()" ng-disabled="mapContainer.$invalid">Get Directions</button> <button class="getDirections" ng-click="clearDirections()" ng-disabled="mapContainer.$invalid">Clear</button><br /></form>',link:function(n){n.$on("add-gas-station",function(e,t){null!=t.name&&null!=t.address&&null!=t.city&&null!=t.state&&null!=t.zip&&null!=t.reg&&"N/A"==t.reg?n.addGasStation(parseFloat(t.lat),parseFloat(t.lng),t.name,t.address,t.city,t.state,t.zip,t.reg="Price is Unavailable"):n.addGasStation(parseFloat(t.lat),parseFloat(t.lng),t.name,t.address,t.city,t.state,t.zip,t.reg)}),console.log("working!!!!!!!!!!!"),n.init=function(){var i={zoom:void 0!==n.zoom?n.zoom:16,mapTypeId:n.type.toLowerCase(),streetViewControl:!1};e=new google.maps.Map(document.getElementById("theMap"),i),n.endPoint=void 0!==n.destination?n.destination:"8012 San Miguel Cir Buena Park, CA 90620",r.geocode({address:n.endPoint},function(i,a){var r=i[0].geometry.location;a===google.maps.GeocoderStatus.OK?(e.setCenter(r),t=new google.maps.Marker({map:e,position:r,animation:google.maps.Animation.DROP}),o=new google.maps.InfoWindow({content:void 0!==n.markerContent?n.markerContent:"Google HQ"}),google.maps.event.addListener(t,"click",function(){return o.open(e,t)})):alert("Cannot Geocode")})},n.init(),n.getDirections=function(){var t={origin:n.origin,destination:n.endPoint,travelMode:google.maps.DirectionsTravelMode.DRIVING};a.route(t,function(e,t){t===google.maps.DirectionsStatus.OK?(i.setDirections(e),n.mileDistance=e.routes[0].legs[0].distance.text,console.log(n.mileDistance),n.showSteps(e),document.getElementById("wrongAddress").style.display="none"):document.getElementById("wrongAddress").style.display="block"}),i.setMap(e),i.setPanel(document.getElementById("directionsList"))},n.showSteps=function(t){var o=t.routes[0];n.milesPerMarker=62137e-8*t.routes[0].legs[0].distance.value/o.overview_path.length,n.$parent.$parent.updateMilesPerMarker(n.milesPerMarker),n.$parent.$parent.$watch("num",function(t){for(var i=t;i<o.overview_path.length;i+=t)new google.maps.Marker({position:o.overview_path[i],icon:"/images/gasstations/red_fuel.png",map:e}),n.$parent.$parent.gasStations(o.overview_path[i].B,o.overview_path[i].k),$("#directionsList").show()})},n.addGasStation=function(t,n,o,i,a,r,s,l){var d='<div id="content"><div id="siteNotice"></div><h2 id="firstHeading" class="firstHeading">'+o+"</h2><h5> Regular Gas Price: "+l+'</h5><div id="bodyContent"><p>'+i+"</p><p>"+a+", "+r+" "+s+"</p></div></div>",c=new google.maps.InfoWindow({content:d}),p=new google.maps.LatLng(t,n),m=new google.maps.Marker({position:p,icon:"/images/gasstations/red_fuel.png",map:e});google.maps.event.addListener(m,"click",function(){console.log("Clicked"),c.open(e,m)})},n.clearDirections=function(){n.init(),i.setPanel(null),n.origin=""}}}});